ТекстЗапроса = "ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.Дата КАК Дата,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	ВЫБОР
               |		КОГДА DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Значение ССЫЛКА Справочник.Контрагенты
               |			ТОГДА ВЫРАЗИТЬ(DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Значение КАК Справочник.Контрагенты)
               |		КОГДА DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Значение ССЫЛКА Справочник.Организации
               |			ТОГДА ВЫРАЗИТЬ(DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Значение КАК Справочник.Организации)
               |	КОНЕЦ КАК Грузоотправитель,
               |	ВЫБОР
               |		КОГДА DR_ДокументыДополнительныеРеквизиты_Грузополучатель.Значение ССЫЛКА Справочник.Организации
               |			ТОГДА ВЫРАЗИТЬ(DR_ДокументыДополнительныеРеквизиты_Грузополучатель.Значение КАК Справочник.Организации)
               |	КОНЕЦ КАК Грузополучатель,
               |	ВЫБОР
               |		КОГДА DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Значение ССЫЛКА Справочник.Контрагенты
               |			ТОГДА ВЫРАЗИТЬ(DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Значение КАК Справочник.Контрагенты)
               |		КОГДА DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Значение ССЫЛКА Справочник.Организации
               |			ТОГДА ВЫРАЗИТЬ(DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Значение КАК Справочник.Организации)
               |	КОНЕЦ КАК Грузоперевозчик,
               |	ВЫБОР
               |		КОГДА DR_ДокументыДополнительныеРеквизиты_Организация.Значение ССЫЛКА Справочник.Организации
               |			ТОГДА ВЫРАЗИТЬ(DR_ДокументыДополнительныеРеквизиты_Организация.Значение КАК Справочник.Организации)
               |	КОНЕЦ КАК Организация,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_ON_TRNACLGROT
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Грузоотправитель
               |		ПО (DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Ссылка)
               |			И (DR_ДокументыДополнительныеРеквизиты_Грузоотправитель.Реквизит = ""Грузоотправитель"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Грузополучатель
               |		ПО (DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Грузополучатель.Ссылка)
               |			И (DR_ДокументыДополнительныеРеквизиты_Грузополучатель.Реквизит = ""Грузополучатель"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик
               |		ПО (DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Ссылка)
               |			И (DR_ДокументыДополнительныеРеквизиты_Грузоперевозчик.Реквизит = ""Грузоперевозчик"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_Организация
               |		ПО (DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_Организация.Ссылка)
               |			И (DR_ДокументыДополнительныеРеквизиты_Организация.Реквизит = ""Организация"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNACLGROT_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |	И DR_Документы.Дата МЕЖДУ &ДатаНач И &ДатаКон
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_ON_TRNACLPPRIN
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""Документ_ИдИнфГО_ИдФайлИнфГО"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNACLPPRIN_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |	И DR_Документы.Дата >= &ДатаНач
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_ON_TRNACLGRPO
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""ИдентификаторОснования"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNACLGRPO_Исходящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |	И DR_Документы.Дата >= &ДатаНач
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_ON_TRNACLPVYN
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""Документ_ИдИнфГП_ИдФайлИнфГП"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNACLPVYN_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |	И DR_Документы.Дата >= &ДатаНач
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_ON_TRNPEREADR
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""Документ_ИдИнфПрвПрием_ИдФайлПрвПрием"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNPEREADR_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |	И DR_Документы.Дата >= &ДатаНач
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_Документы.Ссылка КАК Ссылка,
               |	DR_Документы.ИдентификаторДокумента КАК ИдентификаторДокумента,
               |	DR_Документы.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_ДокументыДополнительныеРеквизиты_ИдОсн.Значение КАК ИдентификаторОснования,
               |	DR_Документы.Статус КАК Статус
               |ПОМЕСТИТЬ ВТ_ON_TRNZAMEN
               |ИЗ
               |	Документ.DR_Документы КАК DR_Документы
               |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документы.ДополнительныеРеквизиты КАК DR_ДокументыДополнительныеРеквизиты_ИдОсн
               |		ПО DR_Документы.Ссылка = DR_ДокументыДополнительныеРеквизиты_ИдОсн.Ссылка
               |			И (DR_ДокументыДополнительныеРеквизиты_ИдОсн.Реквизит = ""Документ_ИдИнфПрвПрием_ИдФайлПрвПрием"")
               |ГДЕ
               |	DR_Документы.ВидДокумента = ""ON_TRNZAMEN_Входящий""
               |	И НЕ DR_Документы.ПометкаУдаления
               |	И DR_Документы.Дата >= &ДатаНач
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	ВЫБОР
               |		КОГДА НЕ DR_Документ_ON_TRNACLPVYN_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLPVYN_Входящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNACLGRPO_Исходящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLGRPO_Исходящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNPEREADR_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNPEREADR_Входящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNZAMEN_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNZAMEN_Входящий.Ссылка
               |		КОГДА НЕ DR_Документ_ON_TRNACLPPRIN_Входящий.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ_ON_TRNACLPPRIN_Входящий.Ссылка
               |		КОГДА НЕ DR_Документ.Ссылка ЕСТЬ NULL
               |			ТОГДА DR_Документ.Ссылка
               |	КОНЕЦ КАК Документ_Основание,
               |	ЕСТЬNULL(DR_Документ.Статус, """") КАК Статус_ON_TRNACLGROT_Входящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNACLPPRIN_Входящий.Статус, """") КАК Статус_ON_TRNACLPPRIN_Входящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNACLGRPO_Исходящий.Статус, """") КАК Статус_ON_TRNACLGRPO_Исходящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNACLPVYN_Входящий.Статус, """") КАК Статус_ON_TRNACLPVYN_Входящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Входящий.Статус, """") КАК Статус_ON_TRNPEREADR_Входящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNZAMEN_Входящий.Статус, """") КАК Статус_ON_TRNZAMEN_Входящий,
               |	ЕСТЬNULL(DR_Документ_ON_TRNACLPPRIN_Входящий.Ссылка, ЗНАЧЕНИЕ(Документ.DR_Документы.ПустаяСсылка)) КАК ON_TRNACLPPRIN_Входящий,
               |	DR_Документ.Дата КАК ДатаДокумента,
               |	ВЫБОР
               |		КОГДА DR_Документ_ON_TRNACLPVYN_Входящий.Статус = ""ОбработанСОшибкойГИСЭПД""
               |				ИЛИ DR_Документ_ON_TRNACLGRPO_Исходящий.Статус = ""ОбработанСОшибкойГИСЭПД""
               |				ИЛИ DR_Документ_ON_TRNPEREADR_Входящий.Статус = ""ОбработанСОшибкойГИСЭПД""
               |				ИЛИ DR_Документ_ON_TRNZAMEN_Входящий.Статус = ""ОбработанСОшибкойГИСЭПД""
               |				ИЛИ DR_Документ_ON_TRNACLPPRIN_Входящий.Статус = ""ОбработанСОшибкойГИСЭПД""
               |				ИЛИ DR_Документ.Статус = ""ОбработанСОшибкойГИСЭПД""
               |			ТОГДА ""Обработан с ошибкой ГИС ЭПД""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNACLPVYN_Входящий.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNACLPVYN_Входящий.Статус, """") = ""УспешноОбработанГИСЭПД""
               |			ТОГДА ""Груз сдан перевозчиком""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNACLGRPO_Исходящий.Статус, """") = ""Отправлен""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNACLGRPO_Исходящий.Статус, """") = ""УспешноОбработанГИСЭПД""
               |			ТОГДА ""Груз принят получателем""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Входящий.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNPEREADR_Входящий.Статус, """") = ""УспешноОбработанГИСЭПД""
               |			ТОГДА ""Груз переадресован""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNZAMEN_Входящий.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNZAMEN_Входящий.Статус, """") = ""УспешноОбработанГИСЭПД""
               |			ТОГДА ""Водитель/ТС заменены""
               |		КОГДА ЕСТЬNULL(DR_Документ_ON_TRNACLPPRIN_Входящий.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ_ON_TRNACLPPRIN_Входящий.Статус, """") = ""УспешноОбработанГИСЭПД""
               |			ТОГДА ""Груз принят перевозчиком""
               |		КОГДА ЕСТЬNULL(DR_Документ.Статус, """") = ""Обработан""
               |				ИЛИ ЕСТЬNULL(DR_Документ.Статус, """") = ""УспешноОбработанГИСЭПД""
               |			ТОГДА ""Груз сдан отправителем""
               |		ИНАЧЕ """"
               |	КОНЕЦ КАК СтатусДокумента,
               |	DR_Документ.Грузоотправитель КАК Грузоотправитель,
               |	DR_Документ.Грузополучатель КАК Грузополучатель,
               |	DR_Документ.Грузоперевозчик КАК Грузоперевозчик,
               |	DR_Документ.Организация КАК Организация
               |ИЗ
               |	ВТ_ON_TRNACLGROT КАК DR_Документ
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNACLPPRIN КАК DR_Документ_ON_TRNACLPPRIN_Входящий
               |			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNACLGRPO КАК DR_Документ_ON_TRNACLGRPO_Исходящий
               |				ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNACLPVYN КАК DR_Документ_ON_TRNACLPVYN_Входящий
               |				ПО DR_Документ_ON_TRNACLGRPO_Исходящий.ИдентификаторДокумента = DR_Документ_ON_TRNACLPVYN_Входящий.ИдентификаторОснования
               |			ПО DR_Документ_ON_TRNACLPPRIN_Входящий.ИдентификаторДокумента = DR_Документ_ON_TRNACLGRPO_Исходящий.ИдентификаторОснования
               |			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNPEREADR КАК DR_Документ_ON_TRNPEREADR_Входящий
               |			ПО DR_Документ_ON_TRNACLPPRIN_Входящий.ИдентификаторДокумента = DR_Документ_ON_TRNPEREADR_Входящий.ИдентификаторОснования
               |			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ON_TRNZAMEN КАК DR_Документ_ON_TRNZAMEN_Входящий
               |			ПО DR_Документ_ON_TRNACLPPRIN_Входящий.ИдентификаторДокумента = DR_Документ_ON_TRNZAMEN_Входящий.ИдентификаторОснования
               |		ПО DR_Документ.ИдентификаторДокумента = DR_Документ_ON_TRNACLPPRIN_Входящий.ИдентификаторОснования"; 