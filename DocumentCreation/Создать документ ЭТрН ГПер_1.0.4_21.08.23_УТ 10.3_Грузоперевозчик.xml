<ValueTree xmlns="http://v8.1c.ru/8.1/data/core" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ValueTree">
	<column>
		<Name xsi:type="xs:string">Использовать</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Кнопка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">КолонкаИсточника</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Источник</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Приемник</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">СлужебныеТекст</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Сохранение</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Загрузка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Формула</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Служебные</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">КоллекцияТЧ</Name>
		<ValueType/>
	</column>
	<row>
		<Value xsi:type="xs:boolean">true</Value>
		<Value xsi:type="xs:string">Создать документ ЭТрН ГПер</Value>
		<Value xsi:type="xs:string">Документ_Основание</Value>
		<Value xsi:type="xs:string"/>
		<Value xsi:type="xs:string">DR_Документы</Value>
		<Value xsi:type="xs:string"/>
		<Value xsi:nil="true"/>
		<Value xsi:nil="true"/>
		<Value xsi:type="xs:string"/>
		<Value xsi:type="xs:string">Если ЗначениеЗаполнено(Источник) Тогда 

	ПродолжитьОбработку = Истина;

	//Основные реквизиты документа
	Если Источник.ВидДокумента = ПолучитьЗначение_Перечисления("ВидыДокументов", "ON_TRNACLGROT_Входящий") Тогда
	    Приемник.ВидДокумента = ПолучитьЗначение_Перечисления("ВидыДокументов", "ON_TRNACLPPRIN_Исходящий");
	    ИмяФайла = "ON_TRNACLPPRIN";
	ИначеЕсли Источник.ВидДокумента = ПолучитьЗначение_Перечисления("ВидыДокументов", "ON_TRNACLGRPO_Входящий") Тогда
		ИмяФайла = "ON_TRNACLPVYN";	
		Приемник.ВидДокумента = ПолучитьЗначение_Перечисления("ВидыДокументов", "ON_TRNACLPVYN_Исходящий");
	Иначе
		ПродолжитьОбработку = Ложь;
	КонецЕсли;
	
	Если Не Источник.Статус = ПолучитьЗначение_Перечисления("Статусы","Обработан") Тогда
		ПродолжитьОбработку = Ложь;
	КонецЕсли;
	
	Если ПродолжитьОбработку Тогда
	
		ПустойUTC = "+00:00";  
		
		Приемник.Дата = ТекущаяДата(); 
		Приемник.ДанныеЭЦП = Источник.ДанныеЭЦП;  // чтобы потом использовать в ЭП
		
		ТЧДопРеквизиты = Источник.ДополнительныеРеквизиты.Выгрузить();
		
		//Дополнительные реквизиты документа	
		СписокРеквизитов = Новый Соответствие;
		СписокРеквизитов.Вставить("Организация", 				ВернутьЗначениеДопРеквизитаИзДокумента("Организация", ТЧДопРеквизиты));
	    СписокРеквизитов.Вставить("Грузоотправитель", 			ВернутьЗначениеДопРеквизитаИзДокумента("Грузоотправитель", ТЧДопРеквизиты));
		СписокРеквизитов.Вставить("Грузополучатель", 			ВернутьЗначениеДопРеквизитаИзДокумента("Грузополучатель", ТЧДопРеквизиты));
		СписокРеквизитов.Вставить("Грузоперевозчик", 			ВернутьЗначениеДопРеквизитаИзДокумента("Грузоперевозчик", ТЧДопРеквизиты));
		СписокРеквизитов.Вставить("ВидДокумента", 				Приемник.ВидДокумента);
		СписокРеквизитов.Вставить("РольУчастникаОбмена", 		"Грузоперевозчик"); 
		СписокРеквизитов.Вставить("ИдентификаторОснования", 	Источник.ИдентификаторДокумента);
		
		Если Источник.ВидДокумента = ПолучитьЗначение_Перечисления("ВидыДокументов", "ON_TRNACLGRPO_Входящий") Тогда
			СписокРеквизитов.Вставить("Заказчик", 					ВернутьЗначениеДопРеквизитаИзДокумента("Заказчик", ТЧДопРеквизиты));
			СписокРеквизитов.Вставить("xmlЗаказчик", 				ВернутьЗначениеДопРеквизитаИзДокумента("xmlЗаказчик", ТЧДопРеквизиты));
		КонецЕсли;
		
		//СписокРеквизитов.Вставить("ДатФайлЗак", 				ВернутьЗначениеДопРеквизитаИзДокумента("ДатФайлЗак", ТЧДопРеквизиты));
		//СписокРеквизитов.Вставить("ВрФайлЗак", 					ВернутьЗначениеДопРеквизитаИзДокумента("ВрФайлЗак", ТЧДопРеквизиты));
		СписокРеквизитов.Вставить("ДатФайлЗак", 				ВернутьЗначениеДопРеквизитаИзДокумента("Документ_ДатИнфГО", ТЧДопРеквизиты));
		СписокРеквизитов.Вставить("ВрФайлЗак", 					ВернутьЗначениеДопРеквизитаИзДокумента("Документ_ВрИнфГО", ТЧДопРеквизиты));
		СписокРеквизитов.Вставить("УИдТрН", 					ВернутьЗначениеДопРеквизитаИзДокумента("УИдТрН", ТЧДопРеквизиты));
		
		//Получаем GUID участников обмена 		
		xmlГрузополучатель  = ВернутьЗначениеДопРеквизитаИзДокумента("xmlГрузополучатель", ТЧДопРеквизиты);
		xmlГрузоотправитель = ВернутьЗначениеДопРеквизитаИзДокумента("xmlГрузоотправитель", ТЧДопРеквизиты);
		xmlГрузоперевозчик  = ВернутьЗначениеДопРеквизитаИзДокумента("xmlГрузоперевозчик", ТЧДопРеквизиты);
		
		СписокРеквизитов.Вставить("xmlОрганизация", 			ВернутьЗначениеДопРеквизитаИзДокумента("xmlОрганизация", ТЧДопРеквизиты));
	    СписокРеквизитов.Вставить("xmlГрузоотправитель", 		xmlГрузоотправитель);
		СписокРеквизитов.Вставить("xmlГрузополучатель", 		xmlГрузополучатель);
		СписокРеквизитов.Вставить("xmlГрузоперевозчик", 		xmlГрузоперевозчик);	                  
		
		Для Каждого Запись из СписокРеквизитов Цикл
			НоваяЗапись = Приемник.ДополнительныеРеквизиты.Добавить();
			
			НоваяЗапись.Реквизит = Запись.Ключ;
			НоваяЗапись.Значение = Запись.Значение;
		КонецЦикла;
		
		GUIDФайла = Новый УникальныйИдентификатор;
		ИдентификаторФайла        = ИмяФайла + "_" + xmlГрузополучатель + "_" + xmlГрузоотправитель + "_" + xmlГрузоперевозчик + "_0_" + Формат(ТекущаяДата(), "ДФ=yyyyMMdd") + "_" + GUIDФайла;
		Приемник.ИдентификаторДокумента = ИдентификаторФайла;	                               		                                	                                
			                                
		Приемник.ПередЗаписьюПроверка();          
	          
		Приемник.Записать();
	
	КонецЕсли;
	
КонецЕсли;</Value>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">4</lastId>
			<item>
				<value xsi:type="xs:string">ДополнительныйПолучатель</value>
				<id xsi:type="xs:decimal">0</id>
			</item>
			<item>
				<value xsi:type="xs:string">Грузоперевозчик</value>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">1</id>
			</item>
			<item>
				<value xsi:type="xs:string">Грузополучатель</value>
				<id xsi:type="xs:decimal">2</id>
			</item>
			<item>
				<value xsi:type="xs:string">Грузоотправитель</value>
				<id xsi:type="xs:decimal">3</id>
			</item>
			<item>
				<value xsi:type="xs:string">ИмяКнопки</value>
				<presentation>Создать документ ЭТрН ГПер</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">4</id>
			</item>
		</Value>
	</row>
</ValueTree>